{"consumes":["application/json"],"produces":["application/json"],"schemes":["http"],"swagger":"2.0","info":{"description":"HTTP API for transcoding media files into different formats using pluggable\nproviders.\n\n## Currently supported providers\n\n+ [Amazon Elastic Transcoder](https://aws.amazon.com/elastictranscoder/)\n+ [Elemental Conductor](https://www.elementaltechnologies.com/products/elemental-conductor)\n+ [Encoding.com](http://api.encoding.com)","title":"video-transcoding-api","license":{"name":"Apache 2.0","url":"http://www.apache.org/licenses/LICENSE-2.0.html"},"version":"1.0.0"},"basePath":"/","paths":{"/jobs":{"post":{"tags":["jobs"],"summary":"Creates a new transcoding job.","operationId":"newJob","parameters":[{"name":"Payload","in":"body","required":true,"schema":{"type":"object","properties":{"presets":{"description":"presets to use in the transcoding job.","type":"array","items":{"type":"string"},"x-go-name":"Presets"},"provider":{"description":"provider to use in this job","type":"string","x-go-name":"Provider"},"source":{"description":"source media for the transcoding job.","type":"string","x-go-name":"Source"},"statusCallbackInterval":{"description":"defines the interval in seconds by which StatusCallbackURL is\ncalled. If not defined, it's set to defaultStatusCallbackInterval.","type":"integer","format":"uint64","x-go-name":"StatusCallbackInterval"},"statusCallbackURL":{"description":"if StatusCallbackURL is defined, this service will make a POST\nrequest to it in the interval defined by StatusCallbackInterval\nuntil the job is finished. The payload will be the same as the one\nreturned by a GET call to /jobs/\u003cjobId\u003e","type":"string","x-go-name":"StatusCallbackURL"},"streamingParams":{"description":"provider Adaptive Streaming parameters","x-go-name":"StreamingParams","$ref":"#/definitions/StreamingParams"}}}}],"responses":{"200":{"$ref":"#/responses/job"},"400":{"$ref":"#/responses/invalidJob"},"500":{"$ref":"#/responses/genericError"}}}},"/jobs/{jobId}":{"get":{"description":"It also queries the provider to get the status of the job.","tags":["jobs"],"summary":"Finds a trancode job using its ID.","operationId":"getJob","parameters":[{"type":"string","x-go-name":"JobID","name":"jobId","in":"path","required":true}],"responses":{"200":{"$ref":"#/responses/jobStatus"},"404":{"$ref":"#/responses/jobNotFound"},"410":{"$ref":"#/responses/jobNotFoundInTheProvider"},"500":{"$ref":"#/responses/genericError"}}}},"/presets/{name}":{"put":{"tags":["presets"],"summary":"Updates a preset using its name.","operationId":"updatePreset","parameters":[{"name":"Payload","in":"body","required":true,"schema":{"$ref":"#/definitions/PresetMap"}},{"type":"string","x-go-name":"Name","name":"name","in":"path","required":true}],"responses":{"200":{"$ref":"#/responses/preset"},"400":{"$ref":"#/responses/invalidPreset"},"404":{"$ref":"#/responses/presetNotFound"},"500":{"$ref":"#/responses/genericError"}}},"delete":{"tags":["presets"],"summary":"Deletes a preset by name.","operationId":"deletePreset","parameters":[{"type":"string","x-go-name":"Name","name":"name","in":"path","required":true}],"responses":{"200":{"$ref":"#/responses/emptyResponse"},"404":{"$ref":"#/responses/presetNotFound"},"500":{"$ref":"#/responses/genericError"}}}},"/presets2":{"post":{"tags":["presets"],"summary":"Creates a new preset on given providers.","operationId":"Output","responses":{"200":{"$ref":"#/responses/newPresetOutputs"},"500":{"$ref":"#/responses/genericError"}}}},"/presetsmap":{"get":{"tags":["presets"],"summary":"List available presets on the API.","operationId":"listPresets","responses":{"200":{"$ref":"#/responses/listPresetMaps"},"500":{"$ref":"#/responses/genericError"}}},"post":{"tags":["presets"],"summary":"Creates a new preset in the API.","operationId":"newPreset","parameters":[{"name":"Payload","in":"body","required":true,"schema":{"$ref":"#/definitions/PresetMap"}}],"responses":{"200":{"$ref":"#/responses/preset"},"400":{"$ref":"#/responses/invalidPreset"},"409":{"$ref":"#/responses/presetAlreadyExists"},"500":{"$ref":"#/responses/genericError"}}}},"/presetsmap/{name}":{"get":{"tags":["presets"],"summary":"Finds a preset using its name.","operationId":"getPreset","parameters":[{"type":"string","x-go-name":"Name","name":"name","in":"path","required":true}],"responses":{"200":{"$ref":"#/responses/preset"},"404":{"$ref":"#/responses/presetNotFound"},"500":{"$ref":"#/responses/genericError"}}}},"/providers":{"get":{"description":"Describe available providers in the API, including their name, capabilities\nand health state.","tags":["providers"],"operationId":"listProviders","responses":{"200":{"$ref":"#/responses/listProviders"},"500":{"$ref":"#/responses/genericError"}}}},"/providers/{name}":{"get":{"description":"Describe available providers in the API, including their name, capabilities\nand health state.","tags":["providers"],"operationId":"getProvider","parameters":[{"type":"string","x-go-name":"Name","name":"name","in":"path","required":true}],"responses":{"200":{"$ref":"#/responses/provider"},"404":{"$ref":"#/responses/providerNotFound"},"500":{"$ref":"#/responses/genericError"}}}}},"definitions":{"Capabilities":{"description":"Capabilities describes the available features in the provider. It specificie\nwhich input and output formats the provider supports, along with\nsupported destinations.","type":"object","properties":{"destinations":{"type":"array","items":{"type":"string"},"x-go-name":"Destinations"},"input":{"type":"array","items":{"type":"string"},"x-go-name":"InputFormats"},"output":{"type":"array","items":{"type":"string"},"x-go-name":"OutputFormats"}},"x-go-package":"github.com/nytm/video-transcoding-api/provider"},"Description":{"description":"It contains the name of the provider, along with its current heath status\nand its capabilities.","type":"object","title":"Description fully describes a provider.","properties":{"capabilities":{"x-go-name":"Capabilities","$ref":"#/definitions/Capabilities"},"enabled":{"type":"boolean","x-go-name":"Enabled"},"health":{"x-go-name":"Health","$ref":"#/definitions/Health"},"name":{"type":"string","x-go-name":"Name"}},"x-go-package":"github.com/nytm/video-transcoding-api/provider"},"Duration":{"description":"A Duration represents the elapsed time between two instants\nas an int64 nanosecond count.  The representation limits the\nlargest representable duration to approximately 290 years.","x-go-package":"time"},"Factory":{"description":"Factory is the function responsible for creating the instance of a\nprovider.","x-go-package":"github.com/nytm/video-transcoding-api/provider"},"Health":{"description":"Health describes the current health status of the provider. If indicates\nwhether the provider is healthy or not, and if it's not healthy, it includes\na message explaining what's wrong.","type":"object","properties":{"message":{"type":"string","x-go-name":"Message"},"ok":{"type":"boolean","x-go-name":"OK"}},"x-go-package":"github.com/nytm/video-transcoding-api/provider"},"InvalidConfigError":{"description":"InvalidConfigError is returned if a provider could not be configured properly","x-go-package":"github.com/nytm/video-transcoding-api/provider"},"Job":{"description":"Job represents the job that is persisted in the repository of the Transcoding\nAPI.","type":"object","required":["providerName","providerJobId","creationTime"],"properties":{"creationTime":{"description":"Time of the creation of the job in the API","x-go-name":"CreationTime","$ref":"#/definitions/Time"},"jobId":{"description":"id of the job. It's automatically generated by the API when creating\na new Job.","type":"string","uniqueItems":true,"x-go-name":"ID"},"providerJobId":{"description":"id of the job on the provider","type":"string","x-go-name":"ProviderJobID"},"providerName":{"description":"name of the provider","type":"string","x-go-name":"ProviderName"},"statusCallbackInterval":{"description":"Interval at which to send status payload as job runs to StatusCallbackURL","type":"integer","format":"uint64","x-go-name":"StatusCallbackInterval"},"statusCallbackURL":{"description":"URL to send status payload as job runs","type":"string","x-go-name":"StatusCallbackURL"},"streamingParams":{"description":"configuration for adaptive streaming jobs\nDefaults to false.","x-go-name":"StreamingParams","$ref":"#/definitions/StreamingParams"}},"x-go-package":"github.com/nytm/video-transcoding-api/db"},"JobNotFoundError":{"description":"JobNotFoundError is returned if a job with a given id could not be found by the provider","type":"object","properties":{"ID":{"type":"string"}},"x-go-package":"github.com/nytm/video-transcoding-api/provider"},"JobStatus":{"description":"JobStatus is the representation of the status as the provide sees it. The\nprovider is able to add customized information in the ProviderStatus field.","type":"object","properties":{"providerJobId":{"type":"string","x-go-name":"ProviderJobID"},"providerName":{"type":"string","x-go-name":"ProviderName"},"providerStatus":{"type":"object","additionalProperties":{"type":"object"},"x-go-name":"ProviderStatus"},"status":{"type":"string","x-go-name":"Status"},"statusMessage":{"type":"string","x-go-name":"StatusMessage"}},"x-go-package":"github.com/nytm/video-transcoding-api/provider"},"Month":{"title":"A Month specifies a month of the year (January = 1, ...).","x-go-package":"time"},"OutputOptions":{"description":"This type includes only configuration parameters that are not defined in\nproviders (like the extension of the output file).","type":"object","title":"OutputOptions is the set of options for the output file.","required":["extension"],"properties":{"extension":{"description":"extension for the output file, it's usually attached to the\ncontainer (for example, webm for VP, mp4 for MPEG-4 and ts for HLS).\n\nThe dot should not be part of the extension, i.e. use \"webm\" instead\nof \".webm\".","type":"string","x-go-name":"Extension"}},"x-go-package":"github.com/nytm/video-transcoding-api/db"},"Preset":{"description":"Preset define the set of parameters of a given preset","type":"object","properties":{"audioBitrate":{"type":"string","x-go-name":"AudioBitrate"},"audioCodec":{"type":"string","x-go-name":"AudioCodec"},"container":{"type":"string","x-go-name":"Container"},"description":{"type":"string","x-go-name":"Description"},"gopMode":{"type":"string","x-go-name":"GopMode"},"gopSize":{"type":"string","x-go-name":"GopSize"},"height":{"type":"string","x-go-name":"Height"},"interlaceMode":{"type":"string","x-go-name":"InterlaceMode"},"name":{"type":"string","x-go-name":"Name"},"profile":{"type":"string","x-go-name":"Profile"},"profileLevel":{"type":"string","x-go-name":"ProfileLevel"},"rateControl":{"type":"string","x-go-name":"RateControl"},"videoBitrate":{"type":"string","x-go-name":"VideoBitrate"},"videoCodec":{"type":"string","x-go-name":"VideoCodec"},"width":{"type":"string","x-go-name":"Width"}},"x-go-package":"github.com/nytm/video-transcoding-api/provider"},"PresetMap":{"description":"Each presetmap is just an aggregator of provider presets, where each preset in\nthe API maps to a preset on each provider","type":"object","title":"PresetMap represents the preset that is persisted in the repository of the\nTranscoding API","required":["name","providerMapping","output"],"properties":{"name":{"description":"name of the preset","type":"string","uniqueItems":true,"x-go-name":"Name"},"output":{"description":"set of options in the output file for this preset.","x-go-name":"OutputOpts","$ref":"#/definitions/OutputOptions"},"providerMapping":{"description":"mapping of provider name to provider's internal preset id.","type":"object","additionalProperties":{"type":"string"},"x-go-name":"ProviderMapping"}},"x-go-package":"github.com/nytm/video-transcoding-api/db"},"Status":{"title":"Status is the status of a transcoding job.","x-go-package":"github.com/nytm/video-transcoding-api/provider"},"StreamingParams":{"type":"object","title":"StreamingParams contains all parameters related to the streaming protocol used.","required":["segmentDuration","protocol"],"properties":{"protocol":{"description":"the protocol name (hls or dash)","type":"string","x-go-name":"Protocol"},"segmentDuration":{"description":"duration of the segment","type":"integer","format":"uint64","x-go-name":"SegmentDuration"}},"x-go-package":"github.com/nytm/video-transcoding-api/provider"},"Time":{"description":"Programs using times should typically store and pass them as values,\nnot pointers.  That is, time variables and struct fields should be of\ntype time.Time, not *time.Time.  A Time value can be used by\nmultiple goroutines simultaneously.\n\nTime instants can be compared using the Before, After, and Equal methods.\nThe Sub method subtracts two instants, producing a Duration.\nThe Add method adds a Time and a Duration, producing a Time.\n\nThe zero value of type Time is January 1, year 1, 00:00:00.000000000 UTC.\nAs this time is unlikely to come up in practice, the IsZero method gives\na simple way of detecting a time that has not been initialized explicitly.\n\nEach Time has associated with it a Location, consulted when computing the\npresentation form of the time, such as in the Format, Hour, and Year methods.\nThe methods Local, UTC, and In return a Time with a specific location.\nChanging the location in this way changes only the presentation; it does not\nchange the instant in time being denoted and therefore does not affect the\ncomputations described in earlier paragraphs.\n\nNote that the Go == operator compares not just the time instant but also the\nLocation. Therefore, Time values should not be used as map or database keys\nwithout first guaranteeing that the identical Location has been set for all\nvalues, which can be achieved through use of the UTC or Local method.","type":"object","title":"A Time represents an instant in time with nanosecond precision.","x-go-package":"time"},"TranscodeProfile":{"type":"object","title":"TranscodeProfile defines the set of inputs necessary for running a transcoding job.","properties":{"Presets":{"type":"array","items":{"$ref":"#/definitions/PresetMap"}},"SourceMedia":{"type":"string"},"StreamingParams":{"$ref":"#/definitions/StreamingParams"}},"x-go-package":"github.com/nytm/video-transcoding-api/provider"},"TranscodingProvider":{"description":"It defines a basic API for transcoding a media and query the status of a\nJob. The underlying provider should handle the profileSpec as desired (it\nmight be a JSON, or an XML, or anything else.","type":"object","title":"TranscodingProvider represents a provider of transcoding.","properties":{"Capabilities":{"description":"Capabilities describes the capabilities of the provider.","$ref":"#/definitions/Capabilities"},"Healthcheck":{"description":"Healthcheck should return nil if the provider is currently available\nfor transcoding videos, otherwise it should return an error\nexplaining what's going on.","type":"string"}},"x-go-package":"github.com/nytm/video-transcoding-api/provider"},"Weekday":{"title":"A Weekday specifies a day of the week (Sunday = 0, ...).","x-go-package":"time"},"baseResponse":{"type":"object","x-go-package":"github.com/nytm/video-transcoding-api/service"},"emptyResponse":{"description":"emptyResponse represents an empty response returned by the API, it's\ncomposed only by the HTTP status code.","x-go-package":"github.com/nytm/video-transcoding-api/service"},"errorResponse":{"description":"errorReponse represents the basic error returned by the API on operation\nfailures.","type":"object","properties":{"error":{"description":"the error message\n\nin: body","type":"string","x-go-name":"Message"}},"x-go-package":"github.com/nytm/video-transcoding-api/service"},"invalidJobResponse":{"type":"object","title":"error returned when the given job data is not valid.","properties":{"Error":{"description":"in: body","$ref":"#/definitions/errorResponse"}},"x-go-package":"github.com/nytm/video-transcoding-api/service"},"jobNotFoundProviderResponse":{"description":"error returned when the given job id could not be found on the underlying\nprovider.","type":"object","properties":{"Error":{"description":"in: body","$ref":"#/definitions/errorResponse"}},"x-go-package":"github.com/nytm/video-transcoding-api/service"},"jobNotFoundResponse":{"type":"object","title":"error returned the given job id could not be found on the API.","properties":{"Error":{"description":"in: body","$ref":"#/definitions/errorResponse"}},"x-go-package":"github.com/nytm/video-transcoding-api/service"},"jobResponse":{"description":"JSON-encoded version of the Job, includes only the id of the job, that can\nbe used for querying the current status of the job.","type":"object","properties":{"Payload":{"description":"in: body","$ref":"#/definitions/partialJob"}},"x-go-package":"github.com/nytm/video-transcoding-api/service"},"jobStatusResponse":{"description":"JSON-encoded JobStatus, containing status information given by the\nunderlying provider.","type":"object","properties":{"Payload":{"description":"in: body","$ref":"#/definitions/JobStatus"}},"x-go-package":"github.com/nytm/video-transcoding-api/service"},"partialJob":{"type":"object","properties":{"jobId":{"description":"unique identifier of the job","type":"string","uniqueItems":true,"x-go-name":"JobID"}},"x-go-package":"github.com/nytm/video-transcoding-api/service"}},"responses":{"emptyResponse":{"description":"emptyResponse represents an empty response returned by the API, it's\ncomposed only by the HTTP status code."},"genericError":{"description":"errorReponse represents the basic error returned by the API on operation\nfailures."},"invalidJob":{"description":"error returned when the given job data is not valid.","schema":{"$ref":"#/definitions/errorResponse"}},"invalidPreset":{"description":"error returned when the given preset data is not valid.","schema":{"$ref":"#/definitions/errorResponse"}},"job":{"description":"JSON-encoded version of the Job, includes only the id of the job, that can\nbe used for querying the current status of the job.","schema":{"$ref":"#/definitions/partialJob"}},"jobNotFound":{"description":"error returned the given job id could not be found on the API.","schema":{"$ref":"#/definitions/errorResponse"}},"jobNotFoundInTheProvider":{"description":"error returned when the given job id could not be found on the underlying\nprovider.","schema":{"$ref":"#/definitions/errorResponse"}},"jobStatus":{"description":"JSON-encoded JobStatus, containing status information given by the\nunderlying provider.","schema":{"$ref":"#/definitions/JobStatus"}},"listPresetMaps":{"description":"response for the listPresetMaps operation. It's actually a JSON-encoded object\ninstead of an array, in the format `presetName: presetObject`","schema":{"type":"object","additionalProperties":{"$ref":"#/definitions/PresetMap"}}},"listProviders":{"description":"response for the listProviders operation. Contains the list of providers\nalphabetically ordered.","schema":{"type":"array","items":{"type":"string"}}},"newPresetOutputs":{"description":"list of the results of the attempt to create a preset\nin each provider."},"preset":{"description":"JSON-encoded preset returned on the newPreset and getPreset operations.","schema":{"$ref":"#/definitions/PresetMap"}},"presetAlreadyExists":{"description":"error returned when trying to create a new preset using a name that is\nalready in-use.","schema":{"$ref":"#/definitions/errorResponse"}},"presetNotFound":{"description":"error returned when the given preset name is not found on the API (either on\ngetPreset or deletePreset operations).","schema":{"$ref":"#/definitions/errorResponse"}},"provider":{"description":"response for the getProvider operation.","schema":{"$ref":"#/definitions/Description"}},"providerNotFound":{"description":"error returned when the given provider name is not found in the API.","schema":{"$ref":"#/definitions/errorResponse"}}}}